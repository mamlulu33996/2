(function(g,a,f){var c=(function(){return{isInter:function(k,l){var i=k.left+k.width/2,j=l.left+l.width/2,m=k.top+k.height/2,n=l.top+l.height/2,o=(k.width+l.width)/2,h=(k.height+l.height)/2;return Math.abs(i-j)<o&&Math.abs(m-n)<h},area:function(h){if(h==document){return{left:document.documentElement.scrollLeft||document.body.scrollLeft,top:document.documentElement.scrollTop||document.body.scrollTop,width:document.documentElement.clientWidth||document.body.clientWidth,height:document.documentElement.clientHeight||document.body.clientHeight}}else{return{left:h.offset().left,top:h.offset().top,width:h.outerWidth(),height:h.outerHeight()}}}}})(),d=0,b,e=function(h,i,k){this.__indexer=d++;this.__uid=new Date().getTime();this.lazy=[];var j={};if(arguments.length>0){this.add(h,i,k)}this.grouper=function(m,l){if(typeof m==="undefined"){return j}m=m||0;if(typeof l==="undefined"){return j[m]||null}else{j[m]=l;return l}}};e._defaultFunction=function(k){var i=this.elem,l=this.lazy,h=this.callback,o=this.option,j=c,n=j.area(i),m=j.area((o&&o._container)&&a(o._container)||document),p=this;if(j.isInter(n,m)){setTimeout(function(){if(!p.loaded){p.loaded=true;var q=(i.attr("tagName")||i.prop("tagName")||"NT").toLowerCase();if(l){if(q=="img"){i.bind("load",function(){var r=a(this);if(o&&o.end){o.end.call(r)}}).attr("src",l)}else{a("<img>").bind("load",function(){i.css({"background-image":"url("+l+")"});if(o&&o.end){o.end.call(i)}}).attr("src",l)}}if(o&&o.start){o.start.call(i)}if(!l){if(o&&o.end){o.end.call(i)}}h&&h.call(p)}},0)}};e.prototype={constructor:e,give:function(h){this.lazy=this.lazy.concat(h);return this},add:function(i,j,k){var l=this,h;if(k&&k.container&&a(k.container).length>0){h=k.container;delete k.container;k._container=h;this.add(h,function(){l.__innerlazy__=new l.constructor(i,j,k).run(h);return l.__innerlazy__});return this}a(i).each(function(){var n=a(this),o=n.attr("lazy"),m=j;(o||m)&&l.lazy.push({elem:n,lazy:o,callback:m,loaded:false,option:k});n.removeAttr("lazy").data("LAZY_UID",l.__indexer+"_"+(++l.__uid))});return this},group:function(i,j,k){var l=this.lazy,m=l.length,h=[],n,p=this;a(j).each(function(){var q=a(this);for(var o=0;o<m;o++){if(!(function(r,s){var t=s[r],u;if(t&&q.data("LAZY_UID")==t.elem.data("LAZY_UID")){u=s.splice(r,1)[0];u.option=a.extend({},u.option,{_container:i});h.push(u);return false}return true})(o,l)){return}}});this.add(i,function(){return p.grouper(k,new p.constructor().give(h).run(i))});return this},addFlash:function(h){return this.add(h,function(){var i=this.elem,j=i.attr("flashsrc");i.append('<embed src="'+j+'"></embed>')})},filter:function(){return this.lazy=a.grep(this.lazy,function(h){return !h.loaded})},each:function(h){var k=this.filter(),l=k.length,h=h||e._defaultFunction;if(l>0){for(var j=0;j<l;j++){h.call(k[j],j)}}return this},run:function(h){var i=this;h=h||g;a(h).bind("scroll resize",function(){i.each()});i.each();return this}};f.plug.lazyload=function(h,i,j){if(typeof b=="undefined"){b=new e(h,i,j);setTimeout(function(){b.run()},0)}else{b.add(h,i,j)}return b};f.plug.lazyload.startNew=function(i,j,k){var h=new e(i,j,k);setTimeout(function(){h.run()},0);return h}})(window,jQuery,SP,undefined);